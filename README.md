This code is based on rotational transformation and orthogonal projection in linear algebra.
